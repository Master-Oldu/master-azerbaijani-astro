---
const { title } = Astro.props;
const url = Astro.url.href;
---

<div class="share-container">
  <!-- Copy -->
  <button
    id="copy-btn"
    class="share-box"
    type="button"
    aria-label="Copy link"
    data-tooltip="Copy link"
  >
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <rect x="9" y="9" width="13" height="13" rx="2"></rect>
      <rect x="3" y="3" width="13" height="13" rx="2"></rect>
    </svg>
  </button>

  <!-- X -->
  <a
    class="share-box"
    href={`https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`}
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Share on X"
    data-tooltip="Share on X"
  >
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M18.9 2H22l-6.8 7.8L23 22h-6.6l-5.2-6.7L5.5 22H2.3l7.3-8.4L1 2h6.7l4.7 6.1L18.9 2z"/>
    </svg>
  </a>

  <!-- LinkedIn -->
  <a
    class="share-box"
    href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`}
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Share on LinkedIn"
    data-tooltip="Share on LinkedIn"
  >
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8h5v16H0zM8 8h4.8v2.2h.1c.7-1.3 2.4-2.7 5-2.7 5.3 0 6.2 3.5 6.2 8v8.5h-5V16c0-1.9 0-4.4-2.7-4.4-2.7 0-3.1 2.1-3.1 4.3v8.1H8z"/>
    </svg>
  </a>

  <!-- Facebook -->
  <a
    class="share-box"
    href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`}
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Share on Facebook"
    data-tooltip="Share on Facebook"
  >
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M22.7 0H1.3C.6 0 0 .6 0 1.3v21.3C0 23.4.6 24 1.3 24h11.5v-9.3H9.7v-3.6h3.1V8.4c0-3 1.8-4.7 4.5-4.7 1.3 0 2.6.1 2.6.1v3h-1.5c-1.5 0-2 .9-2 1.9v2.3h3.4l-.5 3.6h-2.9V24h5.7c.7 0 1.3-.6 1.3-1.3V1.3C24 .6 23.4 0 22.7 0z"/>
    </svg>
  </a>

  <!-- WhatsApp -->
  <a
    class="share-box"
    href={`https://api.whatsapp.com/send?text=${encodeURIComponent(`${title} ${url}`)}`}
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Share on WhatsApp"
    data-tooltip="Share on WhatsApp"
  >
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12.04 2C6.52 2 2.04 6.48 2.04 12c0 1.96.57 3.79 1.55 5.34L2 22l4.79-1.53A9.96 9.96 0 0012.04 22c5.52 0 10-4.48 10-10s-4.48-10-10-10z"/>
    </svg>
  </a>

  <!-- Toast -->
  <span id="copy-toast" class="copy-toast">Copied!</span>
</div>

<script>
  const copyBtn = document.getElementById("copy-btn");
  const toast = document.getElementById("copy-toast");

  copyBtn.addEventListener("click", () => {
    toast.classList.add("show");
    setTimeout(() => {
      toast.classList.remove("show");
    }, 1400);

    if (navigator.clipboard && window.isSecureContext) {
      navigator.clipboard.writeText(window.location.href).catch(() => {});
      return;
    }

    const textarea = document.createElement("textarea");
    textarea.value = window.location.href;
    textarea.style.position = "fixed";
    textarea.style.opacity = "0";
    document.body.appendChild(textarea);
    textarea.focus();
    textarea.select();
    try {
      document.execCommand("copy");
    } catch {}
    document.body.removeChild(textarea);
  });
</script>

<style>
.share-container {
  display: flex;
  gap: 8px;
  align-items: center;
  position: relative;
}

.share-box {
  width: 34px;
  height: 34px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
  border: 1px solid #8fd9c5;
  background-color: #A6E8D5;
  cursor: pointer;
  text-decoration: none;
  transition: background-color 0.15s ease, transform 0.1s ease;
  position: relative;
}

.share-box:hover {
  background-color: #94dcc6;
  transform: translateY(-1px);
}

.share-box svg {
  width: 16px;
  height: 16px;
  fill: #013a78;
}

/* Tooltip */
.share-box::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  background: #013a78;
  color: #fff;
  padding: 4px 8px;
  font-size: 0.7rem;
  border-radius: 6px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
}

.share-box:hover::after {
  opacity: 1;
}

/* Toast */
.copy-toast {
  position: absolute;
  top: -36px;
  left: 50%;
  transform: translateX(-50%) translateY(4px);
  padding: 4px 10px;
  font-size: 0.75rem;
  background: #013a78;
  color: #fff;
  border-radius: 999px;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.2s ease, transform 0.2s ease;
  pointer-events: none;
  white-space: nowrap;
}

.copy-toast.show {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) translateY(0);
}
</style>
